@page
@model EnableAuthenticator
@{
    ViewData["Title"] = "Enable Authenticator";
}

<h2>@ViewData["Title"].</h2>
@if (Model.ShowStatusMessage)
{
    <div class="alert alert-@Model.StatusMessageClass alert-dismissible" role="alert">
        <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        @Model.StatusMessage
    </div>
}

<div>
    <p>In order to use an authenticator app you will need to go through the following steps to enable it</p>
    <hr />
    <div class="row">
        <div class="col-sm-8">
            <div asp-validation-summary="All" class="text-danger"></div>
            <ol class="list">
                <li>
                    Download a two factor authenticator app like Microsoft Authenticator for
                    <a href="https://go.microsoft.com/fwlink/?Linkid=825071">Windows Phone</a>,
                    <a href="https://go.microsoft.com/fwlink/?Linkid=825072">Android</a> and
                    <a href="https://go.microsoft.com/fwlink/?Linkid=825073">iOS</a> or
                    Google authenticator for
                    <a href="https://play.google.com/store/apps/details?id=com.google.android.apps.authenticator2&hl=en">Android</a> and
                    <a href="https://itunes.apple.com/us/app/google-authenticator/id388497605?mt=8">iOS</a>.
                </li>
                <li>Scan the QR Code or enter this key <kbd>@Model.PublicKey</kbd> into your two factor authenticator app. Spaces and casing do not matter.</li>
                <li>
                    Once you have scanned the QR code or input the key above your two factor authentication app will provide you
                    with a unique code. Enter the code in the confirmation box below.

                    <form method="post">
                        <div class="form-group">
                            <label asp-for="VerificationCode" class="control-label">Verification Code</label>
                            <input asp-for="VerificationCode" class="form-control" autocomplete="off"/>
                            <span asp-validation-for="VerificationCode" class="text-danger"></span>
                        </div>
                        <button type="submit" class="btn btn-primary">Verify</button>
                    </form>
                </li>
            </ol>
        </div>
        <div class="col-sm-4">
            <div id="qrCode"></div>
            <div id="qrCodeData" data-url="@Model.AuthenticatorUri"></div>
            <p>To enable QR code generation please read our <a href="https://go.microsoft.com/fwlink/?Linkid=852423">documentation</a>.</p>
        </div>
    </div>
</div>

@section Scripts {
    @await Html.PartialAsync("_ValidationScriptsPartial")
    <style>
        #qrCode { margin: 15px; }
    </style>
}
